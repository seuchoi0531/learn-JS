<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Todo List App</title>
    <style>
      .doneTodo {
        text-decoration: line-through;
      }
    </style>
  </head>
  <body>
    <div id="todo">
      <header>
        <h1>Todo List - ëª©ë¡ ì¡°íšŒ ğŸ™‚</h1>
      </header>
      <div id="main">
        <div id="container">
          <ul>
            <li>
              <h2>ì‡¼í•‘ ëª©ë¡</h2>
              <!-- ìƒˆë¡œìš´ í• ì¼ ì…ë ¥ í¼ -->
              <div class="todoinput">
                <input type="text" autofocus onkeyup="handleKeyup(event)" />
                <button type="button" onclick="handleAdd()">ì¶”ê°€</button>
              </div>
              <!-- í• ì¼ ëª©ë¡ì´ í‘œì‹œë˜ëŠ” ì˜ì—­ -->
              <ul class="todolist">
                <!-- <li data-no="1">
                  <span>1</span>
                  <span><s>ìƒ˜í”Œ1</s></span>
                  <button type="button">ì‚­ì œ</button>
                </li>
                <li data-no="2">
                  <span>2</span>
                  <span><s>ìƒ˜í”Œ2</s></span>
                  <button type="button">ì‚­ì œ</button>
                </li>
                <li data-no="3">
                  <span>3</span>
                  <span>ìƒ˜í”Œ3</span>
                  <button type="button">ì‚­ì œ</button>
                </li> -->
              </ul>
            </li>
          </ul>
        </div>
      </div>
      <footer>
        <p>ë©‹ìŸì´ ì‚¬ìì²˜ëŸ¼ FrontEnd BootCamp</p>
      </footer>
    </div>

    <script>
      /**
       * Todo ì•„ì´í…œ í•˜ë‚˜ë¥¼ í‘œí˜„í•˜ëŠ” DOM ìš”ì†Œë¥¼ ìƒì„±í•˜ëŠ” í•¨ìˆ˜
       * @param {Object} item - Todo ì•„ì´í…œ ê°ì²´ {no: number, title: string, done: boolean}
       * @returns {HTMLElement} ìƒì„±ëœ Todo ì•„ì´í…œì˜ DOM ìš”ì†Œ
       */
      function getTodoItemElem(item) {
        // item -> { no: 3, title: 'ë¼ë©´', done: true } // Todo ê°ì²´
        /* DOM ê°ì²´
      return <li>
        <span>3</span>
        <span>ìƒ˜í”Œ3</span>
        <button type="button">ì‚­ì œ</button>
      </li>
      */

        // <li>
        const liElem = document.createElement("li");
        // <span>
        const noElem = document.createElement("span");
        // <span>
        const titleElem = document.createElement("span");
        // <button>
        const deleteElem = document.createElement("button");

        // 3
        const noTxt = document.createTextNode(item.no);
        // ìƒ˜í”Œ3
        const titleTxt = document.createTextNode(item.title);
        // ì‚­ì œ
        const deleteTxt = document.createTextNode("ì‚­ì œ");

        // <span>3</span>
        noElem.appendChild(noTxt);
        // <span>ìƒ˜í”Œ3</span>
        titleElem.appendChild(titleTxt);
        // <button type="button">ì‚­ì œ</button>
        deleteElem.setAttribute("type", "button");
        titleElem.setAttribute("tabindex", 0); // ì™„ë£Œ/ë¯¸ì™„ë£Œ ì²˜ë¦¬ë¥¼ ìœ„í•œ íƒ­ í¬ì»¤ì‹± ***** ì ‘ê·¼ì„±
        deleteElem.appendChild(deleteTxt);

        // <li><span>3</span></li>
        liElem.appendChild(noElem);
        // <li><span>3</span><span>ìƒ˜í”Œ3</span></li>
        liElem.appendChild(titleElem);
        // <li><span>3</span><span>ìƒ˜í”Œ3</span><button type="button">ì‚­ì œ</button></li>
        liElem.appendChild(deleteElem);

        // custom ì†ì„±
        // <li data-no="3" data-done="false">
        // elem.dataset.no -> 3, elem.dataset.done -> false
        liElem.dataset.no = item.no;
        liElem.dataset.done = item.done;

        // "ì‚­ì œ" ë²„íŠ¼ì— í´ë¦­ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì¶”ê°€
        deleteElem.addEventListener("click", function (event) {
          // noë¥¼ ì°¾ì•„ì„œ~~~ ì²«ë²ˆì§¸ ë°©ë²•
          // const btn = event.target; // í´ë¦­ ì´ë²¤íŠ¸ê°€ ë°œìƒí•œ ìš”ì†Œ(<button>)
          // // btnì˜ ì¡°ìƒì¤‘ ì…€ë ‰í„°ì™€ ì¼ì¹˜í•˜ëŠ” ê°€ì¥ ê°€ê¹Œìš´ ì¡°ìƒ
          // const liNode = btn.closest('li'); // <li data-no="3">
          // deleteItem(liNode.dataset.no);
          // noë¥¼ ì°¾ì•„ì„œ~~~ ë‘ë²ˆì§¸ ë°©ë²•
          // TODO í´ë¡œì € ë‹¨ì›ì—ì„œ ì´ìƒí•œ ë¶€ë¶„ í™•ì¸
          // deleteItem(item.no);
        });

        // ì‚­ì œ ì´ë²¤íŠ¸ ë“±ë¡
        deleteElem.setAttribute("onclick", `deleteItem(${item.no})`);

        // ì™„ë£Œ/ë¯¸ì™„ë£Œ ì²˜ë¦¬
        titleElem.setAttribute("onclick", `toggleDone(${item.no})`);
        // <li>
        //   <span>3</span>
        //   <span>ìƒ˜í”Œ3</span>
        //   <button type="button">ì‚­ì œ</button>
        // </li>
        return liElem;
      }

      /**
       * ì¶”ê°€ ë²„íŠ¼ í´ë¦­ ì‹œ ì‹¤í–‰ë˜ëŠ” ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
       * ì…ë ¥ì°½ì˜ ê°’ì„ ê°€ì ¸ì™€ ìƒˆë¡œìš´ Todo ì•„ì´í…œì„ ì¶”ê°€
       */
      function handleAdd() {
        const inputElem = document.querySelector(".todoinput > input");
        if (inputElem.value.trim() !== "") {
          addItem(inputElem.value.trim()); // <input>, <select> ê°™ì€ í¼ì˜ ì…ë ¥ ìš”ì†Œì—ëŠ” value ì†ì„±ìœ¼ë¡œ ì‚¬ìš©ìê°€ ì…ë ¥/ì„ íƒí•œ ê°’ì´ ì €ì¥ë˜ì–´ ìˆìŒ
          inputElem.value = "";
          inputElem.focus();
        }
      }

      /**
       * ì…ë ¥ì°½ì—ì„œ í‚¤ë³´ë“œ ì…ë ¥ ì‹œ ì‹¤í–‰ë˜ëŠ” ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
       * Enter í‚¤ ì…ë ¥ ì‹œ ì¶”ê°€ ê¸°ëŠ¥ ì‹¤í–‰
       * @param {KeyboardEvent} event - í‚¤ë³´ë“œ ì´ë²¤íŠ¸ ê°ì²´
       */
      function handleKeyup(event) {
        if (event.key === "Enter") handleAdd();
      }

      /**
       * ìƒˆë¡œìš´ Todo ì•„ì´í…œì„ ëª©ë¡ì— ì¶”ê°€í•˜ëŠ” í•¨ìˆ˜
       * @param {string} title - ì¶”ê°€í•  Todo ì•„ì´í…œì˜ ì œëª©
       */
      function addItem(title) {
        const todoList = document.querySelector(".todolist");

        const item = {
          // children: ìì‹ë…¸ë“œì˜ ëª©ë¡(ìš”ì†Œë…¸ë“œ)
          no: todoList.children.length + 1,
          // no: document.querySelectorAll('.todolist > li').length + 1,
          // no: ++itemNo,
          // title: title, // ì†ì„±ê°’ì„ ë‹´ëŠ” ë³€ìˆ˜ê°€ ì†ì„±ëª…ê³¼ ì¼ì¹˜í•  ê²½ìš° ì†ì„±ê°’ ìƒëµ ê°€ëŠ¥
          title,
          done: false, // ë¯¸ì™„ë£Œ ìƒíƒœ
        };
        const todoLi = getTodoItemElem(item);
        console.log(todoLi);

        todoList.appendChild(todoLi);
      }

      /**
       * Todo ì•„ì´í…œì˜ ì™„ë£Œ/ë¯¸ì™„ë£Œ ìƒíƒœë¥¼ í† ê¸€í•˜ëŠ” í•¨ìˆ˜
       * @param {number} no - í† ê¸€í•  Todo ì•„ì´í…œì˜ ë²ˆí˜¸
       */
      // createElementë¥¼ ì‚¬ìš©í•œ ë°©ë²•
      function toggleDone1(no) {
        // 1. ë§¤ê°œë³€ìˆ˜ë¡œ ì£¼ì–´ì§„ noì™€, data-noì˜ ê°’ì´ ê°™ì€ lië¥¼ ê°€ì ¸ì˜´
        const targetLi = document.querySelector(`.todolist > li[data-no="${no}"]`);

        // 2. liì˜ data-doneê°€ "false"ë©´ if, "true"ë©´ else
        if (targetLi.dataset.done === "false") {
          // 3. liì˜ ë‘ë²ˆì§¸ ìš”ì†Œ ë…¸ë“œ(title ìˆëŠ” span)ì˜ ì²«ë²ˆì§¸ ìì‹(í…ìŠ¤íŠ¸ ë…¸ë“œ)
          const titleNode = targetLi.children[1].firstChild;
          // 4. titleì´ ìˆëŠ” í…ìŠ¤íŠ¸ ë…¸ë“œì˜ ë°¸ë¥˜, string íƒ€ì… / ì˜ˆ) "ì½”ë”©ê³µë¶€"
          const titleTxt = titleNode.nodeValue;
          // 5. "ì½”ë”©ê³µë¶€"ë¥¼ ê°–ëŠ” í…ìŠ¤íŠ¸ ë…¸ë“œ ìƒì„±
          const newTextNode = document.createTextNode(titleTxt);
          // 6. ì·¨ì†Œì„ ì— í•´ë‹¹í•˜ëŠ” s ìš”ì†Œ ë…¸ë“œ ìƒì„±
          const cancelElem = document.createElement("s");
          // 7. s ìš”ì†Œ ë…¸ë“œë¥¼ liì˜ ë‘ë²ˆì§¸ ìš”ì†Œ ë…¸ë“œ(title ìˆëŠ” span)ì˜ ë§ˆì§€ë§‰ ìì‹ìœ¼ë¡œ ì¶”ê°€
          // ì·¨ì†Œì„ ì´ ê·¸ì–´ì§€ì§€ ì•Šì€ í…ìŠ¤íŠ¸ê°€ ì²« ë²ˆì§¸ ìì‹ì´ê³ , ì¶”ê°€í•œ ë…¸ë“œëŠ” ë‘ ë²ˆì§¸ ìì‹ì´ ë¨
          targetLi.children[1].appendChild(cancelElem);
          // 8. "ì½”ë”©ê³µë¶€"ë¥¼ ê°–ëŠ” í…ìŠ¤íŠ¸ ë…¸ë“œë¥¼ s ìš”ì†Œ ë…¸ë“œì˜ ë§ˆì§€ë§‰ ìì‹ìœ¼ë¡œ ì¶”ê°€
          cancelElem.appendChild(newTextNode);
          // 9. liì˜ ë‘ë²ˆì§¸ ìš”ì†Œ ë…¸ë“œì˜ ì²« ë²ˆì§¸ ìì‹ ì œê±°
          // ì¶”ê°€í•œ ë…¸ë“œë§Œ ë‚¨ê²Œ ë¨
          targetLi.children[1].firstChild.remove();
          // 10. ì·¨ì†Œì„ ì´ ê·¸ì–´ì¡Œë‹¤ëŠ” ê±´ ì´ë¯¸ ì™„ë£Œí•œ ì¼ì´ë¼ëŠ” ëœ»ì´ë¯€ë¡œ, doneì„ trueë¡œ ë³€ê²½
          // ê·¸ë˜ì•¼ ë‹¤ìŒ ë²ˆ í´ë¦­ ë•Œ elseë¬¸ì˜ ì½”ë“œê°€ ì‹¤í–‰ ë¨
          targetLi.dataset.done = true;
        } else {
          // 3. ìœ„ ifë¬¸ì—ì„œ 3, 4ë¥¼ í•©ì¹œ ê²ƒ, "ì½”ë”©ê³µë¶€" string
          // ì·¨ì†Œì„ ì´ ê·¸ì–´ì§€ê¸° ì „ì—” li>span>"ì½”ë”©ê³µë¶€" ê´€ê³„ì˜€ë‹¤ë©´,
          // ì·¨ì†Œì„ ì´ ê·¸ì–´ì§„ í›„ì—” li>span>s>"ì½”ë”©ê³µë¶€" ê´€ê³„ì´ê¸° ë•Œë¬¸ì— ifë¬¸ê³¼ ì‚´ì§ ë‹¤ë¦„
          const titleTxt = targetLi.children[1].firstChild.firstChild.nodeValue;
          // 4. "ì½”ë”©ê³µë¶€"ë¥¼ ê°–ëŠ” í…ìŠ¤íŠ¸ ë…¸ë“œ ìƒì„±
          const newNode = document.createTextNode(titleTxt);
          // 5. spanì˜ ë§ˆì§€ë§‰ ìì‹ìœ¼ë¡œ í…ìŠ¤íŠ¸ ë…¸ë“œ ì¶”ê°€
          // s ìš”ì†Œ ë…¸ë“œê°€ ì²« ë²ˆì§¸ ìì‹ì´ê³ , ì¶”ê°€í•œ ë…¸ë“œëŠ” ë‘ë²ˆì§¸ ìì‹ì´ ë¨
          targetLi.children[1].appendChild(newNode);
          // 6. spanì˜ ì²« ë²ˆì§¸ ìì‹ ì œê±°
          // ì¶”ê°€í•œ ë…¸ë“œë§Œ ë‚¨ê²Œ ë¨
          targetLi.children[1].firstChild.remove();
          // 7. ì·¨ì†Œì„ ì´ ì œê±°ëë‹¤ëŠ” ê±´ í•´ì•¼í•  ì¼ì´ë¼ëŠ” ëœ»ì´ë¯€ë¡œ, doneì„ falseë¡œ ë³€ê²½
          // ê·¸ë˜ì•¼ ë‹¤ìŒ ë²ˆ í´ë¦­ ë•Œ ifë¬¸ì˜ ì½”ë“œê°€ ì‹¤í–‰ ë¨
          targetLi.dataset.done = false;
        }
      }

      // innerHTMLì„ ì‚¬ìš©í•œ ë°©ë²•
      function toggleDone3(no) {
        // 1. ë§¤ê°œë³€ìˆ˜ë¡œ ì£¼ì–´ì§„ noì™€, data-noì˜ ê°’ì´ ê°™ì€ lië¥¼ ê°€ì ¸ì˜´
        const targetLi = document.querySelector(`.todolist > li[data-no="${no}"]`);
        // 2. ë‘ ë²ˆì§¸ span
        // "ì½”ë”©ê³µë¶€"ê°€ ë“¤ì–´ê°„ span
        const secondSpan = targetLi.children[1];
        // 3. "ì½”ë”©ê³µë¶€"ê°€ ë“¤ì–´ê°„ spanì˜ innerText, ì¦‰ "ì½”ë”©ê³µë¶€"
        // span>"ì½”ë”©ê³µë¶€" ê´€ê³„ì¼ ë•Œ innerTextì— í•´ë‹¹
        // span>s>"ì½”ë”©ê³µë¶€"ì˜ ê´€ê³„ë¼ê³  í•´ë„ innerTextëŠ” íƒœê·¸ë¥¼ ì‹ ê²½ì“°ì§€ ì•Šê¸° ë•Œë¬¸ì—,
        // "ì½”ë”©ê³µë¶€"ë§Œ ì„ íƒë¨
        const titleTxt = secondSpan.innerText;
        // 4. liì˜ data-doneê°€ "false"ë©´ if, "true"ë©´ else
        if (targetLi.dataset.done == "false") {
          // 5. ë‘ ë²ˆì§¸ spanì˜ innerHTMLì„ ì•„ë˜ì²˜ëŸ¼ ë³€ê²½
          // íƒœê·¸ë¥¼ ë„£ì„ê±°ê¸° ë•Œë¬¸ì— innerTextê°€ ì•„ë‹Œ innerHTML
          secondSpan.innerHTML = `<s>${titleTxt}</s>`;
          // 6. ì·¨ì†Œì„ ì´ ê·¸ì–´ì¡Œë‹¤ëŠ” ê±´ ì´ë¯¸ ì™„ë£Œí•œ ì¼ì´ë¼ëŠ” ëœ»ì´ë¯€ë¡œ, doneì„ trueë¡œ ë³€ê²½
          // ê·¸ë˜ì•¼ ë‹¤ìŒ ë²ˆ í´ë¦­ ë•Œ elseë¬¸ì˜ ì½”ë“œê°€ ì‹¤í–‰ ë¨
          targetLi.dataset.done = true;
        } else {
          // 5. ë‘ ë²ˆì§¸ spanì˜ innerHTMLì„ ì•„ë˜ì²˜ëŸ¼ ë³€ê²½
          // secondSpan.innerHTMLì€ "<s>ì½”ë”©ê³µë¶€</s>"ì´ë¯€ë¡œ,
          // ì•„ë˜ì²˜ëŸ¼ ëŒ€ì…í•˜ë©´ "ì½”ë”©ê³µë¶€"ê°€ ëŒ€ì… ë¨
          // ì¦‰, síƒœê·¸ê°€ ì—†ì–´ì§„ ê²ƒì²˜ëŸ¼ ë³´ì„
          secondSpan.innerHTML = titleTxt;
          // 6. ì·¨ì†Œì„ ì´ ì œê±°ëë‹¤ëŠ” ê±´ í•´ì•¼í•  ì¼ì´ë¼ëŠ” ëœ»ì´ë¯€ë¡œ, doneì„ falseë¡œ ë³€ê²½
          // ê·¸ë˜ì•¼ ë‹¤ìŒ ë²ˆ í´ë¦­ ë•Œ ifë¬¸ì˜ ì½”ë“œê°€ ì‹¤í–‰ ë¨
          targetLi.dataset.done = false;
        }
      }

      // í´ë˜ìŠ¤ë¥¼ ì¶”ê°€í•˜ëŠ” ë°©ë²•
      // ë¯¸ë¦¬ ì¶”ê°€í•  í´ë˜ìŠ¤ì— cssì‘ì—…ì„ í•´ì•¼ í•¨
      // ë³´ì´ëŠ” ê²ƒë§Œ ì·¨ì†Œë¡œ ë³´ì´ê¸° ë•Œë¬¸ì—,
      // ë¸Œë¼ìš°ì €, ê²€ìƒ‰ì—”ì§„, ìŠ¤í¬ë¦°ë¦¬ë” ë“±ì€ ì·¨ì†Œëœì§€ ëª¨ë¦„(síƒœê·¸ê°€ ì•„ë‹ˆë¼ì„œ)
      // ì˜ì ê°€ëŠ” ë°©ë²•
      function toggleDone2(no) {
        // 1. ë§¤ê°œë³€ìˆ˜ë¡œ ì£¼ì–´ì§„ noì™€, data-noì˜ ê°’ì´ ê°™ì€ lië¥¼ ê°€ì ¸ì˜´
        const targetLi = document.querySelector(`.todolist > li[data-no="${no}"]`);
        // 2. ë‘ ë²ˆì§¸ span
        // "ì½”ë”©ê³µë¶€"ê°€ ë“¤ì–´ê°„ span
        const secondSpan = targetLi.children[1];
        // 3. liì˜ data-doneê°€ "false"ë©´ if, "true"ë©´ else
        if (targetLi.dataset.done == "false") {
          // 4. doneTodo í´ë˜ìŠ¤ë¥¼ secondSpanì˜ classListì— ì¶”ê°€
          // cssì‘ì—…ì„ í•´ ë‘¬ì„œ ì·¨ì†Œì„  ìŠ¤íƒ€ì¼(text-decoration: line-through)ê°€ ì ìš© ë¨
          secondSpan.classList.add("doneTodo");
          // 5. ì·¨ì†Œì„ ì´ ê·¸ì–´ì¡Œë‹¤ëŠ” ê±´ ì´ë¯¸ ì™„ë£Œí•œ ì¼ì´ë¼ëŠ” ëœ»ì´ë¯€ë¡œ, doneì„ trueë¡œ ë³€ê²½
          // ê·¸ë˜ì•¼ ë‹¤ìŒ ë²ˆ í´ë¦­ ë•Œ elseë¬¸ì˜ ì½”ë“œê°€ ì‹¤í–‰ ë¨
          targetLi.dataset.done = true;
        } else {
          // 4. doneTodo í´ë˜ìŠ¤ë¥¼ secondSpanì˜ classListì—ì„œ ì œê±°
          // ì·¨ì†Œì„  ìŠ¤íƒ€ì¼(text-decoration: line-through)ì´ ì ìš©ëœ í´ë˜ìŠ¤ê°€ ì œê±°ë¨
          // ì¦‰, ì·¨ì†Œì„ ì´ ì‚¬ë¼ì§
          secondSpan.classList.remove("doneTodo");
          // 5. ì·¨ì†Œì„ ì´ ì œê±°ëë‹¤ëŠ” ê±´ í•´ì•¼í•  ì¼ì´ë¼ëŠ” ëœ»ì´ë¯€ë¡œ, doneì„ falseë¡œ ë³€ê²½
          // ê·¸ë˜ì•¼ ë‹¤ìŒ ë²ˆ í´ë¦­ ë•Œ ifë¬¸ì˜ ì½”ë“œê°€ ì‹¤í–‰ ë¨
          targetLi.dataset.done = false;
        }
      }
      /**
       * Todo ì•„ì´í…œì„ ì‚­ì œí•˜ëŠ” í•¨ìˆ˜
       * @param {number} no - ì‚­ì œí•  Todo ì•„ì´í…œì˜ ë²ˆí˜¸
       */
      function deleteItem(no) {
        const targetLi = document.querySelector(`.todolist > li[data-no="${no}"]`);
        targetLi.remove();
      }
    </script>
  </body>
</html>
